version: "3.9"

services:
  node1:
    build:
      context: ..
      dockerfile: docker/Dockerfile.base
    container_name: node-1
    environment:
      NODE_ID: node-1
      HOST: 0.0.0.0
      PORT: 9000
      BOOTSTRAP_PEERS: node2:9001

      LOG_LEVEL: INFO
      LOG_FILE: /app/logs/node-1.log
      CLEAR_LOG: "true"

      WEB_API_PORT: 10000

      # Downtown district
      SENSORS: 4

      # Outdoor temperature (daily variation simulated with noise)
      SENSOR_0_TYPE: numeric
      SENSOR_0_NAME: outdoor_temperature
      SENSOR_0_PERIOD_MS: 5000
      SENSOR_0_MIN: -2
      SENSOR_0_MAX: 38
      SENSOR_0_UNIT: "°C"

      # Road traffic intensity (bursty during rush hours)
      SENSOR_1_TYPE: spike
      SENSOR_1_NAME: vehicle_flow
      SENSOR_1_PERIOD_MS: 3000
      SENSOR_1_BASELINE: 40
      SENSOR_1_SPIKE_HEIGHT: 180
      SENSOR_1_P_SPIKE: 0.2
      SENSOR_1_UNIT: "vehicles/min"

      # Pedestrian density (cyclic)
      SENSOR_2_TYPE: wave
      SENSOR_2_NAME: pedestrian_density
      SENSOR_2_PERIOD_MS: 2000
      SENSOR_2_AMPLITUDE: 120
      SENSOR_2_FREQUENCY: 0.08
      SENSOR_2_UNIT: "people"

      # Noise pollution
      SENSOR_3_TYPE: noise
      SENSOR_3_NAME: ambient_noise
      SENSOR_3_PERIOD_MS: 4000
      SENSOR_3_BASE: 65
      SENSOR_3_NOISE: 12
      SENSOR_3_UNIT: "dB"

    ports:
      - "9000:9000"
      - "10000:10000"
    volumes:
      - ../logs:/app/logs


  node2:
    build:
      context: ..
      dockerfile: docker/Dockerfile.base
    container_name: node-2
    environment:
      NODE_ID: node-2
      HOST: 0.0.0.0
      PORT: 9001
      BOOTSTRAP_PEERS: node3:9002

      LOG_LEVEL: INFO
      LOG_FILE: /app/logs/node-2.log
      CLEAR_LOG: "true"

      WEB_API_PORT: 10001

      # Industrial area
      SENSORS: 4

      SENSOR_0_TYPE: trend
      SENSOR_0_NAME: co2_concentration
      SENSOR_0_PERIOD_MS: 7000
      SENSOR_0_START: 420
      SENSOR_0_SLOPE: 0.6
      SENSOR_0_NOISE: 3
      SENSOR_0_UNIT: "ppm"

      SENSOR_1_TYPE: numeric
      SENSOR_1_NAME: particulate_pm25
      SENSOR_1_PERIOD_MS: 6000
      SENSOR_1_MIN: 5
      SENSOR_1_MAX: 120
      SENSOR_1_UNIT: "µg/m3"

      SENSOR_2_TYPE: numeric
      SENSOR_2_NAME: industrial_temperature
      SENSOR_2_PERIOD_MS: 8000
      SENSOR_2_MIN: 15
      SENSOR_2_MAX: 55
      SENSOR_2_UNIT: "°C"

      SENSOR_3_TYPE: boolean
      SENSOR_3_NAME: alarm_state
      SENSOR_3_PERIOD_MS: 10000
      SENSOR_3_P_TRUE: 0.05
      SENSOR_3_UNIT: "triggered"

    ports:
      - "9001:9001"
      - "10001:10001"
    volumes:
      - ../logs:/app/logs


  node3:
    build:
      context: ..
      dockerfile: docker/Dockerfile.base
    container_name: node-3
    environment:
      NODE_ID: node-3
      HOST: 0.0.0.0
      PORT: 9002
      BOOTSTRAP_PEERS: node1:9000

      LOG_LEVEL: INFO
      LOG_FILE: /app/logs/node-3.log
      CLEAR_LOG: "true"

      WEB_API_PORT: 10002

      # Residential district
      SENSORS: 3

      SENSOR_0_TYPE: numeric
      SENSOR_0_NAME: residential_power_consumption
      SENSOR_0_PERIOD_MS: 4000
      SENSOR_0_MIN: 200
      SENSOR_0_MAX: 1200
      SENSOR_0_UNIT: "kW"

      SENSOR_1_TYPE: categorical
      SENSOR_1_NAME: waste_container_status
      SENSOR_1_PERIOD_MS: 9000
      SENSOR_1_VALUES: "empty,half_full,full"
      SENSOR_1_UNIT: "status"

      SENSOR_2_TYPE: noise
      SENSOR_2_NAME: night_noise_level
      SENSOR_2_PERIOD_MS: 5000
      SENSOR_2_BASE: 45
      SENSOR_2_NOISE: 8
      SENSOR_2_UNIT: "dB"

    ports:
      - "9002:9002"
      - "10002:10002"
    volumes:
      - ../logs:/app/logs


  node4:
    build:
      context: ..
      dockerfile: docker/Dockerfile.base
    container_name: node-4
    environment:
      NODE_ID: node-4
      HOST: 0.0.0.0
      PORT: 9003
      BOOTSTRAP_PEERS: node2:9001

      LOG_LEVEL: INFO
      LOG_FILE: /app/logs/node-4.log
      CLEAR_LOG: "true"

      WEB_API_PORT: 10003

      # Public transport hub
      SENSORS: 3

      SENSOR_0_TYPE: wave
      SENSOR_0_NAME: train_station_occupancy
      SENSOR_0_PERIOD_MS: 2500
      SENSOR_0_AMPLITUDE: 800
      SENSOR_0_FREQUENCY: 0.05
      SENSOR_0_UNIT: "people"

      SENSOR_1_TYPE: spike
      SENSOR_1_NAME: ticket_validations
      SENSOR_1_PERIOD_MS: 3000
      SENSOR_1_BASELINE: 100
      SENSOR_1_SPIKE_HEIGHT: 500
      SENSOR_1_P_SPIKE: 0.25
      SENSOR_1_UNIT: "validations/min"

      SENSOR_2_TYPE: numeric
      SENSOR_2_NAME: platform_temperature
      SENSOR_2_PERIOD_MS: 7000
      SENSOR_2_MIN: 5
      SENSOR_2_MAX: 30
      SENSOR_2_UNIT: "°C"

    ports:
      - "9003:9003"
      - "10003:10003"
    volumes:
      - ../logs:/app/logs


  node5:
    build:
      context: ..
      dockerfile: docker/Dockerfile.base
    container_name: node-5
    environment:
      NODE_ID: node-5
      HOST: 0.0.0.0
      PORT: 9004
      BOOTSTRAP_PEERS: node6:9005

      LOG_LEVEL: INFO
      LOG_FILE: /app/logs/node-5.log
      CLEAR_LOG: "true"

      WEB_API_PORT: 10004

      # River monitoring area
      SENSORS: 3

      SENSOR_0_TYPE: numeric
      SENSOR_0_NAME: river_water_level
      SENSOR_0_PERIOD_MS: 6000
      SENSOR_0_MIN: 0.5
      SENSOR_0_MAX: 4.5
      SENSOR_0_UNIT: "m"

      SENSOR_1_TYPE: trend
      SENSOR_1_NAME: water_temperature
      SENSOR_1_PERIOD_MS: 8000
      SENSOR_1_START: 12
      SENSOR_1_SLOPE: 0.1
      SENSOR_1_NOISE: 0.5
      SENSOR_1_UNIT: "°C"

      SENSOR_2_TYPE: numeric
      SENSOR_2_NAME: water_ph
      SENSOR_2_PERIOD_MS: 10000
      SENSOR_2_MIN: 6.5
      SENSOR_2_MAX: 8.5
      SENSOR_2_UNIT: "pH"

    ports:
      - "9004:9004"
      - "10004:10004"
    volumes:
      - ../logs:/app/logs


  node6:
    build:
      context: ..
      dockerfile: docker/Dockerfile.base
    container_name: node-6
    environment:
      NODE_ID: node-6
      HOST: 0.0.0.0
      PORT: 9005
      BOOTSTRAP_PEERS: node3:9002

      LOG_LEVEL: INFO
      LOG_FILE: /app/logs/node-6.log
      CLEAR_LOG: "true"

      WEB_API_PORT: 10005

      # University / innovation district
      SENSORS: 3

      SENSOR_0_TYPE: numeric
      SENSOR_0_NAME: building_energy_usage
      SENSOR_0_PERIOD_MS: 4000
      SENSOR_0_MIN: 500
      SENSOR_0_MAX: 3000
      SENSOR_0_UNIT: "kW"

      SENSOR_1_TYPE: wave
      SENSOR_1_NAME: campus_wifi_load
      SENSOR_1_PERIOD_MS: 2000
      SENSOR_1_AMPLITUDE: 1000
      SENSOR_1_FREQUENCY: 0.04
      SENSOR_1_UNIT: "devices"

      SENSOR_2_TYPE: boolean
      SENSOR_2_NAME: parking_availability
      SENSOR_2_PERIOD_MS: 7000
      SENSOR_2_P_TRUE: 0.5
      SENSOR_2_UNIT: "available"

    ports:
      - "9005:9005"
      - "10005:10005"
    volumes:
      - ../logs:/app/logs