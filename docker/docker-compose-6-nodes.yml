version: "3.9"

services:
  node1:
    build:
      context: ..
      dockerfile: docker/Dockerfile.base
    container_name: node-1
    environment:
      NODE_ID: node-1
      HOST: 0.0.0.0
      PORT: 9000
      BOOTSTRAP_PEERS: node2:9001

      LOG_LEVEL: INFO
      LOG_FILE: /app/logs/node-1.log
      CLEAR_LOG: "true"

      WEB_API_PORT: 10000

      SENSORS: 3

      SENSOR_0_TYPE: numeric
      SENSOR_0_NAME: temperature
      SENSOR_0_PERIOD_MS: 2000
      SENSOR_0_MIN: 10
      SENSOR_0_MAX: 35
      SENSOR_0_UNIT: "Â°C"

      SENSOR_1_TYPE: boolean
      SENSOR_1_NAME: motion
      SENSOR_1_PERIOD_MS: 5000
      SENSOR_1_P_TRUE: 0.4
      SENSOR_1_UNIT: "detected"

      SENSOR_2_TYPE: wave
      SENSOR_2_NAME: vibration
      SENSOR_2_PERIOD_MS: 1000
      SENSOR_2_AMPLITUDE: 8
      SENSOR_2_FREQUENCY: 0.5
      SENSOR_2_UNIT: "mm/s"
    ports:
      - "9000:9000"
      - "10000:10000"
    volumes:
      - ../logs:/app/logs

  node2:
    build:
      context: ..
      dockerfile: docker/Dockerfile.base
    container_name: node-2
    environment:
      NODE_ID: node-2
      HOST: 0.0.0.0
      PORT: 9001
      BOOTSTRAP_PEERS: node3:9002

      LOG_LEVEL: INFO
      LOG_FILE: /app/logs/node-2.log
      CLEAR_LOG: "true"

      WEB_API_PORT: 10001

      SENSORS: 3

      SENSOR_0_TYPE: numeric
      SENSOR_0_NAME: pressure
      SENSOR_0_PERIOD_MS: 6000
      SENSOR_0_MIN: 900
      SENSOR_0_MAX: 1100
      SENSOR_0_UNIT: "hPa"

      SENSOR_1_TYPE: trend
      SENSOR_1_NAME: air_quality
      SENSOR_1_PERIOD_MS: 12000
      SENSOR_1_START: 30
      SENSOR_1_SLOPE: 1.2
      SENSOR_1_NOISE: 0.8
      SENSOR_1_UNIT: "AQI"

      SENSOR_2_TYPE: spike
      SENSOR_2_NAME: traffic
      SENSOR_2_PERIOD_MS: 2500
      SENSOR_2_BASELINE: 5
      SENSOR_2_SPIKE_HEIGHT: 60
      SENSOR_2_P_SPIKE: 0.25
      SENSOR_2_UNIT: "events/min"
    ports:
      - "9001:9001"
      - "10001:10001"
    volumes:
      - ../logs:/app/logs

  node3:
    build:
      context: ..
      dockerfile: docker/Dockerfile.base
    container_name: node-3
    environment:
      NODE_ID: node-3
      HOST: 0.0.0.0
      PORT: 9002
      BOOTSTRAP_PEERS: node1:9000

      LOG_LEVEL: INFO
      LOG_FILE: /app/logs/node-3.log
      CLEAR_LOG: "true"

      WEB_API_PORT: 10002

      SENSORS: 2

      SENSOR_0_TYPE: categorical
      SENSOR_0_NAME: weather
      SENSOR_0_PERIOD_MS: 7000
      SENSOR_0_VALUES: "sunny,cloudy,rainy,windy"
      SENSOR_0_UNIT: "state"

      SENSOR_1_TYPE: noise
      SENSOR_1_NAME: noise_level
      SENSOR_1_PERIOD_MS: 4000
      SENSOR_1_BASE: 55
      SENSOR_1_NOISE: 10
      SENSOR_1_UNIT: "dB"
    ports:
      - "9002:9002"
      - "10002:10002"
    volumes:
      - ../logs:/app/logs

  node4:
    build:
      context: ..
      dockerfile: docker/Dockerfile.base
    container_name: node-4
    environment:
      NODE_ID: node-4
      HOST: 0.0.0.0
      PORT: 9003
      BOOTSTRAP_PEERS: node2:9001

      LOG_LEVEL: INFO
      LOG_FILE: /app/logs/node-4.log
      CLEAR_LOG: "true"

      WEB_API_PORT: 10003

      SENSORS: 2

      SENSOR_0_TYPE: incremental
      SENSOR_0_NAME: energy
      SENSOR_0_PERIOD_MS: 3000
      SENSOR_0_START: 100
      SENSOR_0_STEP_PCT: 2
      SENSOR_0_UNIT: "kWh"

      SENSOR_1_TYPE: boolean
      SENSOR_1_NAME: street_light
      SENSOR_1_PERIOD_MS: 8000
      SENSOR_1_P_TRUE: 0.6
      SENSOR_1_UNIT: "on"
    ports:
      - "9003:9003"
      - "10003:10003"
    volumes:
      - ../logs:/app/logs

  node5:
    build:
      context: ..
      dockerfile: docker/Dockerfile.base
    container_name: node-5
    environment:
      NODE_ID: node-5
      HOST: 0.0.0.0
      PORT: 9004
      BOOTSTRAP_PEERS: node6:9005

      LOG_LEVEL: INFO
      LOG_FILE: /app/logs/node-5.log
      CLEAR_LOG: "true"

      WEB_API_PORT: 10004

      SENSORS: 2

      SENSOR_0_TYPE: numeric
      SENSOR_0_NAME: water_level
      SENSOR_0_PERIOD_MS: 5500
      SENSOR_0_MIN: 0
      SENSOR_0_MAX: 3.2
      SENSOR_0_UNIT: "m"

      SENSOR_1_TYPE: spike
      SENSOR_1_NAME: emergency_calls
      SENSOR_1_PERIOD_MS: 6000
      SENSOR_1_BASELINE: 0
      SENSOR_1_SPIKE_HEIGHT: 10
      SENSOR_1_P_SPIKE: 0.15
      SENSOR_1_UNIT: "calls/min"
    ports:
      - "9004:9004"
      - "10004:10004"
    volumes:
      - ../logs:/app/logs

  node6:
    build:
      context: ..
      dockerfile: docker/Dockerfile.base
    container_name: node-6
    environment:
      NODE_ID: node-6
      HOST: 0.0.0.0
      PORT: 9005
      BOOTSTRAP_PEERS: node3:9002

      LOG_LEVEL: INFO
      LOG_FILE: /app/logs/node-6.log
      CLEAR_LOG: "true"

      WEB_API_PORT: 10005

      SENSORS: 2

      SENSOR_0_TYPE: trend
      SENSOR_0_NAME: co2
      SENSOR_0_PERIOD_MS: 6500
      SENSOR_0_START: 420
      SENSOR_0_SLOPE: 0.8
      SENSOR_0_NOISE: 2.0
      SENSOR_0_UNIT: "ppm"

      SENSOR_1_TYPE: wave
      SENSOR_1_NAME: pedestrian_flow
      SENSOR_1_PERIOD_MS: 2000
      SENSOR_1_AMPLITUDE: 40
      SENSOR_1_FREQUENCY: 0.12
      SENSOR_1_UNIT: "people/min"
    ports:
      - "9005:9005"
      - "10005:10005"
    volumes:
      - ../logs:/app/logs